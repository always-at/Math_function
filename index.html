<!DOCTYPE html>
<html lang="zh-Hant">
<head>
	<meta charset="UTF-8">
	<title>Online Plot!</title>
	
	<!--js_database------------------------------>
	<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.5.0/math.js"></script>
	
	<!--CSS code------------------------------>
	<style>
	.Font36px {
		font-size: 36px;
	}

	</style>
</head>


<body>
	<h2 class="Font36px">Input a function：</h2>
	<input class="Font36px" type="text" id="functionInput" value="cos(x)">

	<button class="Font36px" onclick="resetGraph()">重設</button>
	<button class="Font36px" id="toggleMoveBtn" onclick="toggleMove()">繪圖</button>

	<div id="graph" style="width:90%;max-width:1200px;height:400px;"></div>
	<script>
		let t = 10; // 起始右界
		let intervalId;
		
		function resetGraph() {
			clearInterval(intervalId); // 停止動畫
			intervalId = null;         // 清空定時器id
			t = 10;
			plotGraph(false);          // 重新繪圖，不啟動動畫
		}
		
		
		function toggleMove() {
			const btn = document.getElementById('toggleMoveBtn');
			if (!intervalId) {
				intervalId = setInterval(() => {
				t += 0.1;
				plotGraph();
				}, 100);
				btn.textContent = '停止';
			} else {
				clearInterval(intervalId);
				intervalId = null;
				btn.textContent = '移動';
			}
		}
	
		function plotGraph(dynamic = false) {
			const exprStr = document.getElementById('functionInput').value;
			const expr = math.parse(exprStr).compile();
			const xValues = [];
			const yValues = [];
			for (let x = t - 10; x <= t; x += 0.1) {
				xValues.push(x);
				yValues.push(expr.evaluate({ x }));
			}
			const trace = {
				x: xValues,
				y: yValues,
				type: 'scatter',
				mode: 'lines'
			};
			const layout = {
				title: exprStr,
				xaxis: { title: 'x' },
				yaxis: { title: 'y' }
			};
			Plotly.newPlot('graph', [trace], layout);
		
			if(dynamic && !intervalId) {
				intervalId = setInterval(() => {
					t += 0.1;
					plotGraph(true);
				}, 100);
			}
		}
	
	

	
	</script>

</body>
</html>
